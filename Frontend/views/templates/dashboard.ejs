<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SOILY - Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/logo2.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #25995c;
        --primary-dark: #007236;
        --secondary: #34d399;
        --bg-light: #f0fdf4;
        --text-dark: #1f2937;
        --text-light: #6b7280;
        --border: #e5e7eb;
        --white: #ffffff;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      body {
        font-family: "Poppins", sans-serif;
        background: var(--bg-light);
        color: var(--text-dark);
        line-height: 1.6;
      }

      /* Sidebar */
      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        height: 100vh;
        width: 260px;
        background: var(--white);
        border-right: 1px solid var(--border);
        padding: 24px 0;
        overflow-y: auto;
        transition: transform 0.3s ease;
        z-index: 1000;
      }

      .sidebar.hidden {
        transform: translateX(-100%);
      }

      .sidebar-header {
        padding: 0 24px 24px;
        border-bottom: 1px solid var(--border);
      }

      .logo-container {
        display: flex;
        align-items: center;
      }

      .logo-container img {
        width: auto;
        height: 60px;
        margin: 0 auto;
        /* margin-bottom: 20px; */
      }

      .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
        font-size: 20px;
      }

      .logo-text {
        font-size: 22px;
        font-weight: 700;
        color: var(--primary);
      }

      .nav-menu {
        padding: 24px 0;
      }

      .nav-item {
        padding: 12px 24px;
        display: flex;
        align-items: center;
        gap: 12px;
        color: var(--text-light);
        text-decoration: none;
        transition: all 0.2s;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
      }

      .nav-item:hover,
      .nav-item.active {
        background: var(--bg-light);
        color: var(--primary);
        border-left: 3px solid var(--primary);
      }

      .nav-icon {
        width: 20px;
        height: 20px;
      }

      /* Main Content */
      .main-content {
        margin-left: 260px;
        min-height: 100vh;
        transition: margin-left 0.3s ease;
      }

      .main-content.expanded {
        margin-left: 0;
      }

      /* Top Bar */
      .top-bar {
        background: var(--white);
        padding: 16px 32px;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .menu-toggle {
        display: none;
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
      }

      .search-box {
        display: flex;
        align-items: center;
        gap: 8px;
        background: var(--bg-light);
        padding: 8px 16px;
        border-radius: 8px;
        flex: 1;
        max-width: 400px;
      }

      .search-box input {
        border: none;
        background: none;
        outline: none;
        width: 100%;
        font-family: "Poppins", sans-serif;
      }

      .top-bar-actions {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .language-selector {
        padding: 8px 12px;
        border: 1px solid var(--border);
        border-radius: 6px;
        background: var(--white);
        cursor: pointer;
        font-family: "Poppins", sans-serif;
        font-size: 14px;
      }

      .notification-btn {
        position: relative;
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
      }

      .notification-badge {
        position: absolute;
        top: 4px;
        right: 4px;
        width: 8px;
        height: 8px;
        background: #ef4444;
        border-radius: 50%;
      }

      .user-profile {
        display: flex;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: background 0.2s;
      }

      .user-profile:hover {
        background: var(--bg-light);
      }

      .user-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 14px;
      }

      .user-info h4 {
        font-size: 14px;
        font-weight: 600;
      }

      .user-info p {
        font-size: 12px;
        color: var(--text-light);
      }

      /* Dashboard Content */
      .dashboard-content {
        padding: 32px;
      }

      .page-header {
        margin-bottom: 32px;
      }

      .page-title {
        font-size: 28px;
        font-weight: 700;
        color: var(--text-dark);
        margin-bottom: 8px;
      }

      .page-subtitle {
        color: var(--text-light);
        font-size: 14px;
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
      }

      .stat-card {
        background: var(--white);
        padding: 24px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        transition: transform 0.2s;
      }

      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
      }

      .stat-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
      }

      .stat-icon.primary {
        background: rgba(37, 153, 92, 0.1);
        color: var(--primary);
      }

      .stat-icon.secondary {
        background: rgba(52, 211, 153, 0.1);
        color: var(--secondary);
      }

      .stat-icon.warning {
        background: rgba(251, 191, 36, 0.1);
        color: #f59e0b;
      }

      .stat-icon.info {
        background: rgba(59, 130, 246, 0.1);
        color: #3b82f6;
      }

      .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-dark);
        margin-bottom: 4px;
      }

      .stat-label {
        color: var(--text-light);
        font-size: 14px;
        font-weight: 500;
      }

      .stat-trend {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 12px;
        margin-top: 8px;
      }

      .stat-trend.up {
        color: #10b981;
      }

      .stat-trend.down {
        color: #ef4444;
      }

      /* Weather Card */
      .weather-card {
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        color: white;
        padding: 24px;
        border-radius: 12px;
        box-shadow: var(--shadow-lg);
        margin-bottom: 32px;
      }

      .weather-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .weather-location {
        font-size: 18px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .weather-time {
        font-size: 12px;
        opacity: 0.9;
      }

      .weather-main {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .weather-temp {
        font-size: 56px;
        font-weight: 700;
      }

      .weather-desc {
        font-size: 16px;
        opacity: 0.9;
        margin-top: 8px;
      }

      .weather-icon {
        font-size: 72px;
      }

      .weather-details {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }

      .weather-detail {
        text-align: center;
      }

      .weather-detail-label {
        font-size: 12px;
        opacity: 0.8;
        margin-bottom: 4px;
      }

      .weather-detail-value {
        font-size: 18px;
        font-weight: 600;
      }

      /* Content Grid */
      .content-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 24px;
        margin-bottom: 32px;
      }

      .card {
        background: var(--white);
        padding: 24px;
        border-radius: 12px;
        box-shadow: var(--shadow);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .card-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-dark);
      }

      .card-action {
        color: var(--primary);
        font-size: 14px;
        text-decoration: none;
        font-weight: 500;
      }

      /* Quick Actions */
      .quick-actions {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
      }

      .action-btn {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px;
        background: var(--bg-light);
        border: 2px solid transparent;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        color: var(--text-dark);
      }

      .action-btn:hover {
        border-color: var(--primary);
        background: white;
      }

      .action-icon {
        width: 40px;
        height: 40px;
        background: var(--primary);
        color: white;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
      }

      .action-text h4 {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 2px;
      }

      .action-text p {
        font-size: 12px;
        color: var(--text-light);
      }

      /* Recent Activity */
      .activity-list {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .activity-item {
        display: flex;
        gap: 12px;
        padding: 12px;
        background: var(--bg-light);
        border-radius: 8px;
      }

      .activity-icon {
        width: 36px;
        height: 36px;
        border-radius: 8px;
        background: var(--primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .activity-content h4 {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 2px;
      }

      .activity-content p {
        font-size: 12px;
        color: var(--text-light);
      }

      .activity-time {
        font-size: 11px;
        color: var(--text-light);
        margin-top: 4px;
      }

      /* Recommendations */
      .recommendations {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .recommendation-item {
        padding: 16px;
        background: linear-gradient(
          135deg,
          rgba(37, 153, 92, 0.1),
          rgba(52, 211, 153, 0.1)
        );
        border-left: 4px solid var(--primary);
        border-radius: 8px;
      }

      .recommendation-item h4 {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 4px;
        color: var(--primary);
      }

      .recommendation-item p {
        font-size: 13px;
        color: var(--text-dark);
      }

      /* Responsive */
      @media (max-width: 1024px) {
        .content-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.active {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
        }

        .menu-toggle {
          display: block;
        }

        .dashboard-content {
          padding: 20px;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .weather-details {
          grid-template-columns: repeat(2, 1fr);
        }

        .quick-actions {
          grid-template-columns: 1fr;
        }

        .search-box {
          display: none;
        }

        .user-info {
          display: none;
        }
      }

      /* Loading */
      .loading {
        text-align: center;
        padding: 20px;
        color: var(--text-light);
      }

      .spinner {
        border: 3px solid var(--border);
        border-top: 3px solid var(--primary);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 12px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo-container">
          <img src="/logo1.png" alt="" />
        </div>
      </div>

      <nav class="nav-menu">
        <a href="/dashboard" class="nav-item active">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
            />
          </svg>
          <span data-translate="nav_dashboard">Dashboard</span>
        </a>

        <a href="/soil-map" class="nav-item">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"
            />
          </svg>
          <span data-translate="nav_soil_map">Soil Map</span>
        </a>

        <a href="/analysis" class="nav-item">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
            />
          </svg>
          <span data-translate="nav_analysis">Analysis</span>
        </a>

        <a href="/recommendations" class="nav-item">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
            />
          </svg>
          <span data-translate="nav_recommendations">Recommendations</span>
        </a>

        <a href="/reports" class="nav-item">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
            />
          </svg>
          <span data-translate="nav_reports">Reports</span>
        </a>

        <a href="/profile" class="nav-item">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            />
          </svg>
          <span data-translate="nav_profile">Profile</span>
        </a>

        <a href="/settings" class="nav-item">
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          <span data-translate="nav_settings">Settings</span>
        </a>

        <a
          href="/auth/logout"
          class="nav-item"
          style="margin-top: 20px; color: #ef4444"
        >
          <svg
            class="nav-icon"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
            />
          </svg>
          <span data-translate="nav_logout">Logout</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
      <!-- Top Bar -->
      <div class="top-bar">
        <button class="menu-toggle" id="menuToggle">
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            />
          </svg>
        </button>

        <div class="search-box">
          <svg
            width="20"
            height="20"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            />
          </svg>
          <input
            type="text"
            placeholder="Search..."
            data-translate-placeholder="search_placeholder"
          />
        </div>

        <div class="top-bar-actions">
          <select class="language-selector" id="languageSelector">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
            <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
            <option value="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</option>
            <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
            <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
            <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
            <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
            <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
          </select>

          <button class="notification-btn">
            <svg
              width="24"
              height="24"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
              />
            </svg>
            <span class="notification-badge"></span>
          </button>

          <div class="user-profile" onclick="window.location.href='/profile'">
            <div class="user-avatar" id="userAvatar">F</div>
            <div class="user-info">
              <h4 id="userName">Farmer</h4>
              <p id="userLocation">Loading...</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Dashboard Content -->
      <div class="dashboard-content">
        <!-- Page Header -->
        <div class="page-header">
          <h1 class="page-title" data-translate="welcome">Welcome back</h1>
          <p class="page-subtitle" data-translate="dashboard_subtitle">
            Here's what's happening with your farm today
          </p>
        </div>

        <!-- Weather Card -->
        <div class="weather-card" id="weatherCard">
          <div class="loading">
            <div class="spinner"></div>
            <p data-translate="loading_weather">Loading weather data...</p>
          </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="farmArea">0</div>
                <div class="stat-label" data-translate="stat_farm_area">
                  Farm Area (Acres)
                </div>
              </div>
              <div class="stat-icon primary">üåæ</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="soilHealth">--</div>
                <div class="stat-label" data-translate="stat_soil_health">
                  Soil Health Score
                </div>
              </div>
              <div class="stat-icon secondary">üå±</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="activeMaps">0</div>
                <div class="stat-label" data-translate="stat_active_maps">
                  Active Maps
                </div>
              </div>
              <div class="stat-icon warning">üó∫Ô∏è</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="recommendations">0</div>
                <div class="stat-label" data-translate="stat_recommendations">
                  New Recommendations
                </div>
              </div>
              <div class="stat-icon info">üí°</div>
            </div>
          </div>
        </div>

        <!-- Content Grid -->
        <div class="content-grid">
          <!-- Quick Actions -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title" data-translate="quick_actions">
                Quick Actions
              </h3>
            </div>
            <div class="quick-actions">
              <a href="/soil-map/new" class="action-btn">
                <div class="action-icon">üó∫Ô∏è</div>
                <div class="action-text">
                  <h4 data-translate="action_new_map">Create Soil Map</h4>
                  <p data-translate="action_new_map_desc">
                    Draw or upload farm area
                  </p>
                </div>
              </a>
              <a href="/analysis/upload" class="action-btn">
                <div class="action-icon">üìä</div>
                <div class="action-text">
                  <h4 data-translate="action_upload_data">Upload Lab Data</h4>
                  <p data-translate="action_upload_data_desc">
                    Add soil test results
                  </p>
                </div>
              </a>
              <a href="/recommendations" class="action-btn">
                <div class="action-icon">üí°</div>
                <div class="action-text">
                  <h4 data-translate="action_view_recommendations">
                    View Recommendations
                  </h4>
                  <p data-translate="action_view_recommendations_desc">
                    Get crop suggestions
                  </p>
                </div>
              </a>
              <a href="/reports/generate" class="action-btn">
                <div class="action-icon">üìÑ</div>
                <div class="action-text">
                  <h4 data-translate="action_generate_report">
                    Generate Report
                  </h4>
                  <p data-translate="action_generate_report_desc">
                    Export PDF analysis
                  </p>
                </div>
              </a>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title" data-translate="recent_activity">
                Recent Activity
              </h3>
              <a href="/activity" class="card-action" data-translate="view_all"
                >View All</a
              >
            </div>
            <div class="activity-list" id="activityList">
              <div class="loading">
                <div class="spinner"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Recommendations Card -->
        <div class="card">
          <div class="card-header">
            <h3
              class="card-title"
              data-translate="personalized_recommendations"
            >
              Personalized Recommendations
            </h3>
            <a
              href="/recommendations"
              class="card-action"
              data-translate="view_all"
              >View All</a
            >
          </div>
          <div class="recommendations" id="recommendationsList">
            <div class="loading">
              <div class="spinner"></div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Translation data
      const translations = {
        en: {
          app_name: "Soily",
          nav_dashboard: "Dashboard",
          nav_soil_map: "Soil Map",
          nav_analysis: "Analysis",
          nav_recommendations: "Recommendations",
          nav_reports: "Reports",
          nav_profile: "Profile",
          nav_settings: "Settings",
          nav_logout: "Logout",
          search_placeholder: "Search...",
          welcome: "Welcome back",
          dashboard_subtitle: "Here's what's happening with your farm today",
          loading_weather: "Loading weather data...",
          stat_farm_area: "Farm Area (Acres)",
          stat_soil_health: "Soil Health Score",
          stat_active_maps: "Active Maps",
          stat_recommendations: "New Recommendations",
          quick_actions: "Quick Actions",
          action_new_map: "Create Soil Map",
          action_new_map_desc: "Draw or upload farm area",
          action_upload_data: "Upload Lab Data",
          action_upload_data_desc: "Add soil test results",
          action_view_recommendations: "View Recommendations",
          action_view_recommendations_desc: "Get crop suggestions",
          action_generate_report: "Generate Report",
          action_generate_report_desc: "Export PDF analysis",
          recent_activity: "Recent Activity",
          view_all: "View All",
          personalized_recommendations: "Personalized Recommendations",
        },
        hi: {
          app_name: "‡§∏‡•ã‡§á‡§≤‡•Ä",
          nav_dashboard: "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
          nav_soil_map: "‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡§æ ‡§®‡§ï‡•ç‡§∂‡§æ",
          nav_analysis: "‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",
          nav_recommendations: "‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç",
          nav_reports: "‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü",
          nav_profile: "‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤",
          nav_settings: "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",
          nav_logout: "‡§≤‡•â‡§ó‡§Ü‡§â‡§ü",
          search_placeholder: "‡§ñ‡•ã‡§ú‡•á‡§Ç...",
          welcome: "‡§µ‡§æ‡§™‡§∏‡•Ä ‡§™‡§∞ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à",
          dashboard_subtitle: "‡§Ü‡§ú ‡§Ü‡§™‡§ï‡•á ‡§ñ‡•á‡§§ ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à",
          loading_weather: "‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
          stat_farm_area: "‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ (‡§è‡§ï‡§°‡§º)",
          stat_soil_health: "‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•ç‡§ï‡•ã‡§∞",
          stat_active_maps: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ï‡•ç‡§∂‡•á",
          stat_recommendations: "‡§®‡§à ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç",
          quick_actions: "‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø",
          action_new_map: "‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡§æ ‡§®‡§ï‡•ç‡§∂‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç",
          action_new_map_desc: "‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§¨‡§®‡§æ‡§è‡§Ç",
          action_upload_data: "‡§≤‡•à‡§¨ ‡§°‡•á‡§ü‡§æ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
          action_upload_data_desc: "‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
          action_view_recommendations: "‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç",
          action_view_recommendations_desc: "‡§´‡§∏‡§≤ ‡§∏‡•Å‡§ù‡§æ‡§µ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç",
          action_generate_report: "‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç",
          action_generate_report_desc: "PDF ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç",
          recent_activity: "‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø",
          view_all: "‡§∏‡§≠‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç",
          personalized_recommendations: "‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç",
        },
        mr: {
          app_name: "‡§∏‡•ã‡§á‡§≤‡•Ä",
          nav_dashboard: "‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
          nav_soil_map: "‡§Æ‡§æ‡§§‡•Ä‡§ö‡§æ ‡§®‡§ï‡§æ‡§∂‡§æ",
          nav_analysis: "‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",
          nav_recommendations: "‡§∂‡§ø‡§´‡§æ‡§∞‡§∏‡•Ä",
          nav_reports: "‡§Ö‡§π‡§µ‡§æ‡§≤",
          nav_profile: "‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤",
          nav_settings: "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§ú",
          nav_logout: "‡§≤‡•â‡§ó‡§Ü‡§â‡§ü",
          search_placeholder: "‡§∂‡•ã‡§ß‡§æ...",
          welcome: "‡§™‡§∞‡§§ ‡§Ø‡•á‡§£‡•ç‡§Ø‡§æ‡§∏ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§Ü‡§π‡•á",
          dashboard_subtitle: "‡§Ü‡§ú ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§∂‡•á‡§§‡§æ‡§§ ‡§ï‡§æ‡§Ø ‡§ò‡§°‡§§ ‡§Ü‡§π‡•á",
          loading_weather: "‡§π‡§µ‡§æ‡§Æ‡§æ‡§® ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...",
          stat_farm_area: "‡§∂‡•á‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ (‡§è‡§ï‡§∞)",
          stat_soil_health: "‡§Æ‡§æ‡§§‡•Ä ‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø ‡§∏‡•ç‡§ï‡•ã‡§Ö‡§∞",
          stat_active_maps: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ï‡§æ‡§∂‡•á",
          stat_recommendations: "‡§®‡§µ‡•Ä‡§® ‡§∂‡§ø‡§´‡§æ‡§∞‡§∏‡•Ä",
          quick_actions: "‡§ú‡§≤‡§¶ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ",
          action_new_map: "‡§Æ‡§æ‡§§‡•Ä‡§ö‡§æ ‡§®‡§ï‡§æ‡§∂‡§æ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ",
          action_new_map_desc: "‡§∂‡•á‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ",
          action_upload_data: "‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡§∂‡§æ‡§≥‡§æ ‡§°‡•á‡§ü‡§æ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡§æ",
          action_upload_data_desc: "‡§Æ‡§æ‡§§‡•Ä ‡§ö‡§æ‡§ö‡§£‡•Ä ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ú‡•ã‡§°‡§æ",
          action_view_recommendations: "‡§∂‡§ø‡§´‡§æ‡§∞‡§∏‡•Ä ‡§™‡§π‡§æ",
          action_view_recommendations_desc: "‡§™‡•Ä‡§ï ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§Æ‡§ø‡§≥‡§µ‡§æ",
          action_generate_report: "‡§Ö‡§π‡§µ‡§æ‡§≤ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ",
          action_generate_report_desc: "PDF ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§∞‡§æ",
          recent_activity: "‡§Ö‡§≤‡•Ä‡§ï‡§°‡•Ä‡§≤ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ï‡§≤‡§æ‡§™",
          view_all: "‡§∏‡§∞‡•ç‡§µ ‡§™‡§π‡§æ",
          personalized_recommendations: "‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§∂‡§ø‡§´‡§æ‡§∞‡§∏‡•Ä",
        },
      };

      // Dashboard Controller
      class SoilyDashboard {
        constructor() {
          this.currentLanguage = "en";
          this.farmerData = null;
          this.init();
        }

        async init() {
          this.setupEventListeners();
          await this.loadFarmerData();
          await this.loadWeather();
          this.loadRecentActivity();
          this.loadRecommendations();
        }

        setupEventListeners() {
          // Menu toggle
          const menuToggle = document.getElementById("menuToggle");
          const sidebar = document.getElementById("sidebar");
          const mainContent = document.getElementById("mainContent");

          menuToggle?.addEventListener("click", () => {
            sidebar.classList.toggle("active");
          });

          // Language selector
          const languageSelector = document.getElementById("languageSelector");
          languageSelector?.addEventListener("change", (e) => {
            this.changeLanguage(e.target.value);
          });

          // Close sidebar on outside click (mobile)
          document.addEventListener("click", (e) => {
            if (window.innerWidth <= 768) {
              if (
                !sidebar.contains(e.target) &&
                !menuToggle.contains(e.target)
              ) {
                sidebar.classList.remove("active");
              }
            }
          });
        }

        async loadFarmerData() {
          try {
            const response = await fetch("/api/farmer/profile");
            const data = await response.json();

            if (data.success && data.farmer) {
              this.farmerData = data.farmer;
              this.updateUI();
            }
          } catch (error) {
            console.error("Failed to load farmer data:", error);
          }
        }

        updateUI() {
          const farmer = this.farmerData;

          // Update user info
          document.getElementById("userName").textContent = farmer.fullName;
          document.getElementById("userLocation").textContent = farmer.location;
          document.getElementById("userAvatar").textContent = farmer.fullName
            .charAt(0)
            .toUpperCase();

          // Set language
          if (farmer.preferredLanguage) {
            this.currentLanguage = farmer.preferredLanguage;
            document.getElementById("languageSelector").value =
              farmer.preferredLanguage;
            this.translatePage(farmer.preferredLanguage);
          }

          // Update stats
          const farmSizes = {
            small: "2",
            medium: "6",
            large: "30",
            xlarge: "100",
          };
          document.getElementById("farmArea").textContent =
            farmSizes[farmer.farmSize] || "0";
          document.getElementById("soilHealth").textContent = "75"; // Mock data
          document.getElementById("activeMaps").textContent = "3"; // Mock data
          document.getElementById("recommendations").textContent = "5"; // Mock data
        }

        async loadWeather() {
          const weatherCard = document.getElementById("weatherCard");

          if (!this.farmerData?.location) {
            weatherCard.innerHTML =
              '<div class="loading"><p>Location not available</p></div>';
            return;
          }

          try {
            // Using OpenWeatherMap API - replace with your API key
            const apiKey = "0a315c49aff3f7e234472a7e343be4a2";
            const location = this.farmerData.location;
            const response = await fetch(
              `https://api.openweathermap.org/data/2.5/weather?q=${location},IN&units=metric&appid=${apiKey}`
            );

            if (!response.ok) throw new Error("Weather fetch failed");

            const weather = await response.json();
            this.displayWeather(weather);
          } catch (error) {
            console.error("Weather fetch error:", error);
            // Display mock weather data
            this.displayMockWeather();
          }
        }

        displayWeather(weather) {
          const weatherCard = document.getElementById("weatherCard");
          const weatherEmoji = this.getWeatherEmoji(weather.weather[0].main);

          weatherCard.innerHTML = `
                    <div class="weather-header">
                        <div class="weather-location">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            ${weather.name}
                        </div>
                        <div class="weather-time">${new Date().toLocaleTimeString(
                          "en-US",
                          { hour: "2-digit", minute: "2-digit" }
                        )}</div>
                    </div>
                    <div class="weather-main">
                        <div>
                            <div class="weather-temp">${Math.round(
                              weather.main.temp
                            )}¬∞C</div>
                            <div class="weather-desc">${
                              weather.weather[0].description
                            }</div>
                        </div>
                        <div class="weather-icon">${weatherEmoji}</div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-detail">
                            <div class="weather-detail-label">Humidity</div>
                            <div class="weather-detail-value">${
                              weather.main.humidity
                            }%</div>
                        </div>
                        <div class="weather-detail">
                            <div class="weather-detail-label">Wind Speed</div>
                            <div class="weather-detail-value">${
                              weather.wind.speed
                            } m/s</div>
                        </div>
                        <div class="weather-detail">
                            <div class="weather-detail-label">Feels Like</div>
                            <div class="weather-detail-value">${Math.round(
                              weather.main.feels_like
                            )}¬∞C</div>
                        </div>
                    </div>
                `;
        }

        displayMockWeather() {
          const weatherCard = document.getElementById("weatherCard");
          const location = this.farmerData?.location || "Your Farm";

          weatherCard.innerHTML = `
                    <div class="weather-header">
                        <div class="weather-location">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            ${location}
                        </div>
                        <div class="weather-time">${new Date().toLocaleTimeString(
                          "en-US",
                          { hour: "2-digit", minute: "2-digit" }
                        )}</div>
                    </div>
                    <div class="weather-main">
                        <div>
                            <div class="weather-temp">28¬∞C</div>
                            <div class="weather-desc">Partly cloudy</div>
                        </div>
                        <div class="weather-icon">‚õÖ</div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-detail">
                            <div class="weather-detail-label">Humidity</div>
                            <div class="weather-detail-value">65%</div>
                        </div>
                        <div class="weather-detail">
                            <div class="weather-detail-label">Wind Speed</div>
                            <div class="weather-detail-value">12 km/h</div>
                        </div>
                        <div class="weather-detail">
                            <div class="weather-detail-label">Feels Like</div>
                            <div class="weather-detail-value">30¬∞C</div>
                        </div>
                    </div>
                `;
        }

        getWeatherEmoji(condition) {
          const emojis = {
            Clear: "‚òÄÔ∏è",
            Clouds: "‚òÅÔ∏è",
            Rain: "üåßÔ∏è",
            Drizzle: "üå¶Ô∏è",
            Thunderstorm: "‚õàÔ∏è",
            Snow: "‚ùÑÔ∏è",
            Mist: "üå´Ô∏è",
            Fog: "üå´Ô∏è",
          };
          return emojis[condition] || "üå§Ô∏è";
        }

        loadRecentActivity() {
          const activityList = document.getElementById("activityList");

          // Mock recent activity data
          const activities = [
            {
              icon: "üó∫Ô∏è",
              title: "Soil map created",
              desc: "North Field - 5 acres",
              time: "2 hours ago",
            },
            {
              icon: "üìä",
              title: "Lab results uploaded",
              desc: "NPK analysis completed",
              time: "1 day ago",
            },
            {
              icon: "üí°",
              title: "New recommendation",
              desc: "Wheat cultivation suggested",
              time: "2 days ago",
            },
            {
              icon: "üìÑ",
              title: "Report generated",
              desc: "Quarterly soil health report",
              time: "3 days ago",
            },
          ];

          activityList.innerHTML = activities
            .map(
              (activity) => `
                    <div class="activity-item">
                        <div class="activity-icon">${activity.icon}</div>
                        <div class="activity-content">
                            <h4>${activity.title}</h4>
                            <p>${activity.desc}</p>
                            <div class="activity-time">${activity.time}</div>
                        </div>
                    </div>
                `
            )
            .join("");
        }

        loadRecommendations() {
          const recommendationsList = document.getElementById(
            "recommendationsList"
          );

          // Mock recommendations data
          const recommendations = [
            {
              title: "Optimal Crop Selection",
              desc: "Based on current soil pH (6.5) and NPK levels, consider planting wheat or barley this season.",
            },
            {
              title: "Fertilizer Application",
              desc: "Your soil requires additional potassium. Apply 50kg potash per acre before sowing.",
            },
            {
              title: "Irrigation Schedule",
              desc: "With current moisture levels at 45%, schedule irrigation for next 3 days.",
            },
          ];

          recommendationsList.innerHTML = recommendations
            .map(
              (rec) => `
                    <div class="recommendation-item">
                        <h4>${rec.title}</h4>
                        <p>${rec.desc}</p>
                    </div>
                `
            )
            .join("");
        }

        async changeLanguage(lang) {
          this.currentLanguage = lang;
          this.translatePage(lang);

          // Update language preference in backend
          try {
            await fetch("/api/language", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ language: lang }),
            });
          } catch (error) {
            console.error("Failed to update language:", error);
          }
        }

        translatePage(lang) {
          const trans = translations[lang] || translations.en;

          // Translate all elements with data-translate attribute
          document.querySelectorAll("[data-translate]").forEach((element) => {
            const key = element.getAttribute("data-translate");
            if (trans[key]) {
              element.textContent = trans[key];
            }
          });

          // Translate placeholders
          document
            .querySelectorAll("[data-translate-placeholder]")
            .forEach((element) => {
              const key = element.getAttribute("data-translate-placeholder");
              if (trans[key]) {
                element.placeholder = trans[key];
              }
            });
        }
      }

      // Initialize dashboard
      document.addEventListener("DOMContentLoaded", () => {
        new SoilyDashboard();
      });
    </script>
  </body>
</html>
